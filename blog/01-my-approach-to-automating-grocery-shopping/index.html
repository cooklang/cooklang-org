<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>My approach to automating grocery shopping - Cooklang: recipe markup language</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=/favicon.png><link rel=stylesheet href=/css/style.min.6b810f933e568f3ba607b4f5b1cf85fec6ca57b9c291b318c80724d874a7abf3.css></head><body class='page page-default-single'><div id=main-menu-mobile class=main-menu-mobile><ul><li class=menu-item-home><a href=/><span>Home</span></a></li><li class=menu-item-docs><a href=/docs/><span>Docs</span></a></li><li class=menu-item-cli><a href=/cli/><span>CLI</span></a></li><li class="menu-item-mobile app"><a href=/app/><span>Mobile App</span></a></li><li class=menu-item-blog><a href=/blog/><span>Blog</span></a></li></ul></div><div class=wrapper><div class=header><div class=container><div class=logo><a href=/><img alt=Logo src=/images/logo.svg></a></div><div class=logo-mobile><a href=/><img alt=Logo src=/images/logo.svg></a></div><div id=main-menu class=main-menu><ul><li class=menu-item-home><a href=/><span>Home</span></a></li><li class=menu-item-docs><a href=/docs/><span>Docs</span></a></li><li class=menu-item-cli><a href=/cli/><span>CLI</span></a></li><li class="menu-item-mobile app"><a href=/app/><span>Mobile App</span></a></li><li class="menu-item-blog active"><a href=/blog/><span>Blog</span></a></li></ul></div><button id=toggle-main-menu-mobile class="hamburger hamburger--slider" type=button>
<span class=hamburger-box><span class=hamburger-inner></span></span></button></div></div><div class="container pt-2 pt-md-6 pb-3 pb-md-6"><div class=row><div class="col-12 col-md-3 mb-3"><div class=sidebar><div class=docs-menu><h4>Blog</h4><ul><li><a href=/blog/02-practical-savings-on-groceries-with-cooklang/>Practical savings on groceries with Cooklang and tools</a></li><li><a href=/blog/03-ai-and-the-evolution-of-recipe-formats/>AI and the Evolution of Recipe Formats</a></li><li class=active><a href=/blog/01-my-approach-to-automating-grocery-shopping/>My approach to automating grocery shopping</a></li></ul></div></div></div><div class="col-12 col-md-9"><h1 class=title>My approach to automating grocery shopping</h1><div class=content><p>The pandemic has presented everyone with unique challenges. For me, it became particularly hard to switch to online grocery shopping.</p><p>When I do my shopping offline, I usually don‚Äôt have to plan much, moving through the isles and picking up stuff as I go. It‚Äôs rare that I forget something, but more often I buy things I don‚Äôt actually need, but isn‚Äôt that part of how supermarkets work? In my typical order, I&rsquo;d buy groceries for seven to ten days at a time and it would contain sixty to eighty items in my cart.</p><p>Shopping online is a different story. I can&rsquo;t reproduce the same behaviour and go down every isle. So, I realized I needed to plan my meals. I started writing down ingredients for meals I wanted to make on sticky notes and combining them to make an order.</p><p>This was really tedious. After a few orders, I noticed that it was kind of repetitive. Although my wife will tell you that I just was lazy and didn&rsquo;t want to do boring stuff, the developer in me said, ‚ÄùIt&rsquo;s time to automate this and never solve the same problem again.‚Äù</p><p>That&rsquo;s how <a href=https://cooklang.org/>Cooklang</a> was born.</p><h1 id=about-cooklang>About Cooklang</h1><p>I thought, <em>what if I store my recipes in Markdown-like text files and tag ingredients with @ symbol?</em> Like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    Then add @salt and @ground black pepper{} to taste.
</span></span><span class=line><span class=cl>    Poke holes in @potato{2}.
</span></span><span class=line><span class=cl>    Place @bacon strips{1%kg} on a baking sheet and glaze with @syrup{1/2%tbsp}.
</span></span></code></pre></div><p>That will make recipe files human and machine readable.</p><p>Given these recipe files, computers can create a shopping list and much more: calculate nutrition values, costs or whatever else you could need, given that information for ingredients provided.</p><p>And the recipe is still human readable, so I can be agile and store my recipes in git and perfect them over time (like code refactoring).</p><p>Also, because it&rsquo;s just a simple text format I avoid &ldquo;vendor lock-in&rdquo; problems and can use my recipes the same way when I retire. My recipes are mine, forever.</p><h1 id=about-tools>About tools</h1><p>Having only a language specification isn&rsquo;t really helpful. Yes, I can store my recipes on GitHub and own them, but that&rsquo;s it.</p><p>I imagined it would be nice to have many small applications which can understand the language and do their own thing very well: calculate calories, shopping, costs, smart meal planning, etc. I was really excited.</p><p>I read a wonderful book, <a href=http://craftinginterpreters.com/>Crafting Interpreters</a> by Robert Nystrom, and did a few experiments. I created a simple <a href=https://github.com/cooklang/CookInSwift>parser</a> and <a href=https://github.com/cooklang/CookCLI>CLI app</a>. In this post, I wanted to focus on how I automated shopping. I might write another post about the parser and CLI, if anyone interested, so I will skip all the details about those for now.</p><p>So CLI can understand Cooklang files, extract ingredients, and group them:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    $ cook shopping-list \
</span></span><span class=line><span class=cl>    &gt; Neapolitan\ Pizza.cook \
</span></span><span class=line><span class=cl>    &gt; Root\ Vegetable\ Tray\ Bake.cook
</span></span><span class=line><span class=cl>    BREADS AND BAKED GOODS
</span></span><span class=line><span class=cl>        breadcrumbs                   150 g
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    DRIED HERBS AND SPICES
</span></span><span class=line><span class=cl>        dried oregano                 3 tbsp
</span></span><span class=line><span class=cl>        dried sage                    1 tsp
</span></span><span class=line><span class=cl>        pepper                        1 pinch
</span></span><span class=line><span class=cl>        salt                          25 g, 2 pinches
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    FRUIT AND VEG
</span></span><span class=line><span class=cl>        beetroots                     300 g
</span></span><span class=line><span class=cl>        carrots                       300 g
</span></span><span class=line><span class=cl>        celeriac                      300 g
</span></span><span class=line><span class=cl>        fresh basil                   18 leaves
</span></span><span class=line><span class=cl>        garlic                        3 gloves
</span></span><span class=line><span class=cl>        lemon                         1 item
</span></span><span class=line><span class=cl>        onion                         1 large
</span></span><span class=line><span class=cl>        red onion                     2 items
</span></span><span class=line><span class=cl>        thyme                         2 springs
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    MEAT AND SEAFOOD
</span></span><span class=line><span class=cl>        parma ham                     3 packs
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    MILK AND DAIRY
</span></span><span class=line><span class=cl>        butter                        15 g
</span></span><span class=line><span class=cl>        egg                           1 item
</span></span><span class=line><span class=cl>        mozzarella                    3 packs
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    OILS AND DRESSINGS
</span></span><span class=line><span class=cl>        Dijon mustard                 1 tsp
</span></span><span class=line><span class=cl>        Marmite                       1 tsp
</span></span><span class=line><span class=cl>        cider                         150 ml
</span></span><span class=line><span class=cl>        olive oil                     3 tbsp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    OTHER (add new items into aisle.conf)
</span></span><span class=line><span class=cl>        tipo zero flour               820 g
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    PACKAGED GOODS, PASTA AND SAUCES
</span></span><span class=line><span class=cl>        vegetable stock               150 ml
</span></span><span class=line><span class=cl>        water                         530 ml
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    TINNED GOODS AND BAKING
</span></span><span class=line><span class=cl>        cannellini beans              400 g
</span></span><span class=line><span class=cl>        chopped tomato                3 cans
</span></span><span class=line><span class=cl>        fresh yeast                   1.6 g
</span></span><span class=line><span class=cl>        redcurrant jelly              1 tsp
</span></span></code></pre></div><p>I can set output format to json or yaml and feed this into other programs, or just use good old plain text output manipulation. CLI has a few more features like a web-server to explore the recipes with cooking mode and make shopping list in the browser.</p><p>I migrated a bunch of recipes from scattered sources into Cooklang format and stored them on GitHub repository <a href=https://github.com/dubadub/cookbook>https://github.com/dubadub/cookbook</a>.</p><h1 id=my-grocery-shopping-approach>My grocery shopping approach</h1><p>Unfortunately, I haven&rsquo;t fully automated my grocery shopping yet. I still need to do some manual steps, because my shop doesn&rsquo;t provide any API access (surprise!).</p><p>That&rsquo;s how my process looks now:</p><p>1/ I generate a list of all ingredients. I added directories with symlinks to recipes, which represent a meal plan. So it&rsquo;s easy to generate a list of ingredients for the whole directory like that:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    $ cook shopping-list --only-ingredients ./Plan\ I
</span></span></code></pre></div><p>2/ I remove anything I already have at home from the list.</p><p>3/ I paste all the ingredients to a multi search input on the shop&rsquo;s web-site.</p><p>4/ I manually go through each item and add it to my cart üòì.</p><p>5/ Done!</p><p>It has a manual step, but:</p><ul><li>it‚Äôs much faster than before.</li><li>it‚Äôs less for me to think about;</li><li>it makes the entire process more precise.</li></ul><p>I&rsquo;m really happy with this precision part. I noticed that I now cover all my needs but no longer over consume. I see this as a form of eco-sufficiency in some ways.</p><h1 id=whats-next>What&rsquo;s next</h1><p>I have only solved 80% of my problem, and I want to do more. I&rsquo;m thinking about creating a mapping between ingredients from my recipes and links to them at my shop&rsquo;s website. That will allow me to use curl or Selenium to complete my solution.</p><p>-Alexey</p><p>Note, originally posted on <a href=https://www.daniweb.com/programming/software-development/threads/537481/my-approach-to-automating-grocery-shopping>Daniweb</a>.</p></div></div></div></div></div></div><div class=sub-footer><div class=container><div class=d-flex><div class=mr-auto><a href=https://github.com/cooklang>github.com/cooklang</a></div><div class=mr-auto><a href=https://discord.gg/fUVVvUzEEK>Discord Server</a></div><div><a href="https://twitter.com/cooklangorg?ref_src=twsrc%5Etfw" class=twitter-follow-button data-show-count=false>Follow @cooklangorg</a><script async src=https://platform.twitter.com/widgets.js></script></div></div></div></div><script type=text/javascript src=/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js></script></body></html>